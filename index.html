<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>event_detector: &lt;em&gt;Event Detector —&lt;/em&gt; A Modular Event Detection Framework for ROS 2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">event_detector<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><em>Event Detector —</em> A Modular Event Detection Framework for ROS 2 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p align="center"><a class="anchor" id="md_README"></a> </p>
<p><img src="https://img.shields.io/github/v/release/ika-rwth-aachen/event_detector" alt="" class="inline"/> <img src="https://img.shields.io/github/license/ika-rwth-aachen/event_detector" alt="" class="inline"/> <a href="https://github.com/ika-rwth-aachen/event_detector/actions/workflows/docker-ros.yml"><img src="https://github.com/ika-rwth-aachen/event_detector/actions/workflows/docker-ros.yml/badge.svg" alt="" style="pointer-events: none;" class="inline"/></a> <a href="https://ika-rwth-aachen.github.io/event_detector/"><img src="https://github.com/ika-rwth-aachen/event_detector/actions/workflows/doc.yml/badge.svg" alt="" style="pointer-events: none;" class="inline"/></a> <img src="https://img.shields.io/badge/ROS 2-humble-293754" alt="" class="inline"/> <a href="https://github.com/ika-rwth-aachen/event_detector"><img src="https://img.shields.io/github/stars/ika-rwth-aachen/event_detector?style=social" alt="" class="inline"/></a> </p>
<p align="center"></p>
<p>⸻ <b><em><a href="#quick-start">Quick Start</a></em></b> | <b><em><a href="#action-plugins">Action Plugins</a></em></b> | <b><em><a href="#installation">Installation</a></em></b> | <b><em><a href="#documentation">Documentation</a></em></b> | <b><em><a href="#research-article">Research Article</a></em></b> | <b><em><a href="#acknowledgements">Acknowledgements</a></em></b> ⸻ </p>
<p>The <em><b>event detector</b></em> is a generic and modular event detection framework for ROS 2 applications. With the event detector, you can automatically ...</p><ul>
<li><em><b>buffer</b></em> ROS messages of arbitrary message type;</li>
<li><em><b>detect</b></em> events by analyzing the buffer contents with custom developer-defined <em><b>analysis rules</b></em>;</li>
<li><em><b>trigger</b></em> custom developer-defined <em><b>actions</b></em> in response to detected events using modular <em><b>action plugins</b></em>.</li>
</ul>
<p>In order to give an example, with the event detector you can automatically ...</p><ul>
<li>buffer robot sensor data;</li>
<li>detect malfunction identified by some quantity exceeding a certain threshold;</li>
<li>trigger the storage of all buffered data leading up to the incident.</li>
</ul>
<p>The example illustrates that the event detector framework is highly modular and customizable.</p><ul>
<li>You can process data of arbitrary ROS message type, including custom type definitions.</li>
<li>You can use any of the existing <em>analysis rules</em> to detect an event (e.g., <em>value exceeding threshold</em>) or define your own logic to detect events by implementing a single C++ function in a custom <em>analysis rule</em>.</li>
<li>You can trigger an <em>action</em> using any of the existing *action plugins* (e.g., for recording a ROS bag) or you can define your own logic to trigger something by implementing a custom <em>action plugin</em>.</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;[!IMPORTANT] <br  />
 This repository is open-sourced and maintained by the <a href="https://www.ika.rwth-aachen.de/"><b>Institute for Automotive Engineering (ika) at RWTH Aachen University</b></a>. <br  />
 <b>Advanced C-ITS Use Cases</b> are one of many research topics within our <a href="https://www.ika.rwth-aachen.de/en/competences/fields-of-research/vehicle-intelligence-automated-driving.html"><em>Vehicle Intelligence &amp; Automated Driving</em></a> domain. <br  />
 If you would like to learn more about how we can support your advanced driver assistance and automated driving efforts, feel free to reach out to us! <br  />
 :email: ***opensource@ika.rwth-aachen.de*** </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md1"></a>
Quick Start</h1>
<blockquote class="doxtable">
<p>&zwj;[!TIP] Check out the <a href="https://github.com/ika-rwth-aachen/event_detector_examples">examples repository</a> to see the event detector and all of its action plugins in action! <br  />
 The examples also give a good idea of potential use cases for the event detector. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md2"></a>
Action Plugins</h1>
<p>Event detector action plugins implement the resulting actions that should be triggered upon the detection of a specific event. The detection of any specific event is closely tied to the action that should be triggered. For this reason, any developer-defined custom analysis rule for event detection is associated with a specific action plugin.</p>
<p>As part of the event detector framework, we provide an initial set of action plugins that cover common uses cases, all listed in the table below. Nevertheless, we highlight that the event detector is designed to be easily extensible with new action plugins or new developer-defined analysis rules.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Common Name   </th><th class="markdownTableHeadNone">Action Plugin   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/ika-rwth-aachen/event_detector_bag_recording">ROS Bag Recording</a>   </td><td class="markdownTableBodyNone"><code>event_detector_bag_recording</code>   </td><td class="markdownTableBodyNone">write data from buffer to ROS bag file    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://github.com/ika-rwth-aachen/event_detector_db_recording">Database Recording</a>   </td><td class="markdownTableBodyNone"><code>event_detector_db_recording</code>   </td><td class="markdownTableBodyNone">write data from buffer to a database    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://github.com/ika-rwth-aachen/event_detector_recording_trigger">Recording Trigger</a>   </td><td class="markdownTableBodyNone"><code>event_detector_recording_trigger</code>   </td><td class="markdownTableBodyNone">trigger a (remote) data recording    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Kubernetes Operator   </td><td class="markdownTableBodyNone"><em>work in progress</em>   </td><td class="markdownTableBodyNone">request deployment of applications in Kubernetes   </td></tr>
</table>
<p><img src="./assets/architecture.png" alt="architecture" width="600" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md3"></a>
Installation</h1>
<blockquote class="doxtable">
<p>&zwj;[!WARNING] The core event detector implemented in this repository is not supposed to be used by itself. Please check out the dedicated instructions for the respective action plugin you are interested in. </p>
</blockquote>
<p>You can integrate the event detector into your existing ROS 2 workspace by cloning the repository, installing all dependencies using <a href="http://wiki.ros.org/rosdep"><em>rosdep</em></a>, and then building the event detector from source.</p>
<div class="fragment"><div class="line"># ROS workspace$</div>
<div class="line">git clone https://github.com/ika-rwth-aachen/event_detector.git src/event_detector</div>
<div class="line">rosdep install -r --ignore-src --from-paths src/event_detector</div>
<div class="line">colcon build --packages-up-to event_detector --cmake-args -DCMAKE_BUILD_TYPE=Release</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Documentation</h1>
<h2><a class="anchor" id="autotoc_md5"></a>
Topics, Services, Parameters</h2>
<details >
<summary >
<em>Click to show</em></summary>
<p></p>
<p></p>
</details>
<h3><a class="anchor" id="autotoc_md6"></a>
Subscribed Topics</h3>
<p>Subscriptions for buffering data are specified via the parameter `client_params.&lt;CLIENT_NAME&gt;.data_type_params.&lt;DATA_TYPE&gt;.topics`. Action plugins may define additional subscribers.</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Published Topics</h3>
<p>None by default. Action plugins may define additional publishers.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Services</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Service   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>~/&lt;RULE/NAME&gt;/evaluate</code>   </td><td class="markdownTableBodyNone"><code>std_srvs/srv/Empty</code>   </td><td class="markdownTableBodyNone">allows to trigger a rule evaluation on-demand   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md9"></a>
Parameters</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Options    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>use_sim_time</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>false</code>   </td><td class="markdownTableBodyNone">whether to use ROS simulation time   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>startup_state</code>   </td><td class="markdownTableBodyNone"><code>int</code>   </td><td class="markdownTableBodyNone"><code>1</code>   </td><td class="markdownTableBodyNone">initial lifecycle state   </td><td class="markdownTableBodyNone"><code>1</code> (unconfigured), <code>2</code> (inactive), <code>3</code> (active)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>buffer.default_time</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone"><code>10.0</code>   </td><td class="markdownTableBodyNone">default buffer length (in seconds)   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>buffer.default_queue_size</code>   </td><td class="markdownTableBodyNone"><code>int</code>   </td><td class="markdownTableBodyNone"><code>20</code>   </td><td class="markdownTableBodyNone">default subscriber queue size   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>buffer.initialization_bags</code>   </td><td class="markdownTableBodyNone"><code>string[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">ROS bag files to initialize buffer with   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>buffer.use_msg_stamp</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>true</code>   </td><td class="markdownTableBodyNone">whether to use message stamp for sorting, if present   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>analysis.default_period</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone"><code>1.0</code>   </td><td class="markdownTableBodyNone">default period (in seconds) between subsequent analysis rule evaluations   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>clients</code>   </td><td class="markdownTableBodyNone"><code>string[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">client names   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>client_params.&lt;CLIENT_NAME&gt;.base_frame</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone"><code>""</code>   </td><td class="markdownTableBodyNone">client base frame used for storing static transforms   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>client_params.&lt;CLIENT_NAME&gt;.tf_prefix</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone"><code>""</code>   </td><td class="markdownTableBodyNone">client-specific prefix of frames found in dynamic transforms   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>client_params.&lt;CLIENT_NAME&gt;.data_types</code>   </td><td class="markdownTableBodyNone"><code>string[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">data types to subscribe   </td><td class="markdownTableBodyNone">see second column in <a href="./event_detector/include/event_detector/datatypes.macro"><code>datatypes.macro</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>client_params.&lt;CLIENT_NAME&gt;.data_type_params.&lt;DATA_TYPE&gt;.topics</code>   </td><td class="markdownTableBodyNone"><code>string[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">topic names   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>client_params.&lt;CLIENT_NAME&gt;.data_type_params.&lt;DATA_TYPE&gt;.buffer_times</code>   </td><td class="markdownTableBodyNone"><code>float[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">buffer length (in seconds) for each topic   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>client_params.&lt;CLIENT_NAME&gt;.data_type_params.&lt;DATA_TYPE&gt;.queue_sizes</code>   </td><td class="markdownTableBodyNone"><code>int[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">queue size for each topic   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>rules</code>   </td><td class="markdownTableBodyNone"><code>string[]</code>   </td><td class="markdownTableBodyNone"><code>[]</code>   </td><td class="markdownTableBodyNone">rule names   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>rule_params.&lt;RULE_NAME&gt;.enabled</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>false</code>   </td><td class="markdownTableBodyNone">whether rule is enabled   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>rule_params.&lt;RULE_NAME&gt;.parameters</code>   </td><td class="markdownTableBodyNone"><code>dict</code>   </td><td class="markdownTableBodyNone"><code>{}</code>   </td><td class="markdownTableBodyNone">custom rule parameters   </td><td class="markdownTableBodyNone">see rule documentation   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md10"></a>
Supported data types</h2>
<details >
<summary >
<em>Click to show</em></summary>
<p></p>
<p>The event detector natively supports most common ROS message types, see the list of supported message packages below. You can also add support for custom data types, see *How to add support for a new data type*.</p><ul>
<li><a href="https://index.ros.org/p/builtin_interfaces/">builtin_interfaces</a></li>
<li><a href="https://index.ros.org/p/diagnostic_msgs/">diagnostic_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_cam_msgs">etsi_its_cam_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_cam_ts_msgs">etsi_its_cam_ts_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_cpm_ts_msgs">etsi_its_cpm_ts_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_denm_msgs">etsi_its_denm_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_mapem_ts_msgs">etsi_its_mapem_ts_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_spatem_ts_msgs">etsi_its_spatem_ts_msgs</a></li>
<li><a href="https://index.ros.org/p/etsi_its_vam_ts_msgs">etsi_its_vam_ts_msgs</a></li>
<li><a href="https://index.ros.org/p/geometry_msgs">geometry_msgs</a></li>
<li><a href="https://index.ros.org/p/nav_msgs">nav_msgs</a></li>
<li><a href="https://github.com/ika-rwth-aachen/perception_interfaces">perception_msgs</a></li>
<li><a href="https://index.ros.org/p/sensor_msgs">sensor_msgs</a></li>
<li><a href="https://index.ros.org/p/shape_msgs">shape_msgs</a></li>
<li><a href="https://index.ros.org/p/std_msgs">std_msgs</a></li>
<li><a href="https://index.ros.org/p/stereo_msgs">stereo_msgs</a></li>
<li><a href="https://index.ros.org/p/tf2_msgs">tf2_msgs</a></li>
<li><a href="https://index.ros.org/p/trajectory_msgs">trajectory_msgs</a></li>
<li><a href="https://index.ros.org/p/vision_msgs">vision_msgs</a></li>
<li><a href="https://index.ros.org/p/visualization_msgs">visualization_msgs</a></li>
</ul>
<p></p>
</details>
<h2><a class="anchor" id="autotoc_md11"></a>
How to add support for a new data type</h2>
<details >
<summary >
<em>Click to show</em></summary>
<p></p>
<p>The event detector natively supports most common ROS message types, see *Supported data types*. Through clever application of preprocessor macros, adding support for a new ROS message type only requires 6 lines of code.</p><ol type="1">
<li>Add a package dependency on your message package in <a href="./event_detector/package.xml"><code>./event_detector/package.xml</code></a>.</li>
<li>Add your message package to the <code>find_package</code>, <code>ament_target_dependencies</code>, and <code>ament_export_dependencies</code> sections of <a href="./event_detector/CMakeLists.txt"><code>./event_detector/CMakeLists.txt</code></a>.</li>
<li>Include the required message type headers in <a href="./event_detector/include/event_detector/datatypes.hpp"><code>./event_detector/include/event_detector/datatypes.hpp</code></a>.</li>
<li>Define a new data type by calling the <code>DATATYPE(TYPE, VAR)</code> macro for each new message type in <a href="./event_detector/include/event_detector/datatypes.macro"><code>./event_detector/include/event_detector/datatypes.macro</code></a>.</li>
</ol>
<p></p>
</details>
<h2><a class="anchor" id="autotoc_md12"></a>
How to implement a custom analysis rule</h2>
<details >
<summary >
<em>Click to show</em></summary>
<p></p>
<p>The detection of any specific event is closely tied to the action that should be triggered. For this reason, any developer-defined custom analysis rule for event detection is associated with a specific action plugin. If the supported action plugins do not work for you, see *How to implement a custom action plugin*.</p>
<p>The steps below describe how to add a custom analysis rule to an existing action plugin, e.g., the <a href="https://github.com/ika-rwth-aachen/event_detector_db_recording">database recording plugin</a>. The steps listed here are generally applicable to any action plugin, but specific action plugins may require plugin-specific steps that are documented in the dedicated plugin repositories.</p><ol type="1">
<li>Create a new header (<code>.hpp</code>) and a new implementation file (<code>.cpp</code>) for the new analysis rule, e.g., <code>src/rules/new_custom_rule/NewCustomRule.cpp</code>. Usually, existing action plugins provide a <code>TemplateRule</code> (e.g., <a href="https://github.com/ika-rwth-aachen/event_detector_db_recording/blob/main/event_detector_db_recording_plugin/include/event_detector_db_recording_plugin/rules/template">here, for the database recording plugin</a>) that you can copy-paste.</li>
<li>Add the new implementation file to the build process in the plugin's <code>CMakeLists.txt</code>. <div class="fragment"><div class="line">add_library(${TARGET_NAME} SHARED</div>
<div class="line">  # ...</div>
<div class="line">  src/rules/new_custom_rule/NewCustomRule.cpp</div>
<div class="line">)</div>
</div><!-- fragment --></li>
<li>Declare a new plugin class in the plugin's <code>plugins.xml</code>. <div class="fragment"><div class="line">&lt;<span class="keywordtype">library</span> <span class="keyword">path</span>=<span class="stringliteral">&quot;&lt;ACTION_PLUGIN&gt;&quot;</span>&gt;</div>
<div class="line">  <span class="comment">&lt;!-- ... --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">class</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;&lt;ACTION_PLUGIN&gt;::NewCustomRule&quot;</span> <span class="keyword">base_class_type</span>=<span class="stringliteral">&quot;event_detector::AnalysisRule&quot;</span> /&gt;</div>
<div class="line">&lt;/<span class="keywordtype">library</span>&gt;</div>
</div><!-- fragment --></li>
<li>Add a new rule-specific section to the plugin's parameter file <code>config/params.yml</code>, where you can enable the new analysis rule and specify parameters. <div class="fragment"><div class="line"># ...</div>
<div class="line">rules:</div>
<div class="line">  - &lt;ACTION_PLUGIN&gt;::NewCustomRule</div>
<div class="line">rule_params:</div>
<div class="line">  enabled: true</div>
<div class="line">  parameters:</div>
<div class="line">    new_custom_param: 3.14</div>
</div><!-- fragment --></li>
<li>Implement the new custom analysis rule. Follow any plugin-specific instructions and follow the plugin's template rule documentation, if existing.</li>
<li>Build the action plugin. <div class="fragment"><div class="line"># ROS workspace$</div>
<div class="line">colcon build --packages-up-to &lt;ACTION_PLUGIN_PKG&gt;</div>
</div><!-- fragment --></li>
</ol>
<p></p>
</details>
<h2><a class="anchor" id="autotoc_md13"></a>
How to implement a custom action plugin</h2>
<details >
<summary >
<em>Click to show</em></summary>
<p></p>
<p>The event detector action plugin architecture is built with <a href="https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Pluginlib.html">ROS 2's <code>pluginlib</code> mechanism</a>. All action plugins are separate ROS packages that build the action plugins as shared libraries, which are loaded by the core event detector node at runtime.</p>
<p>The steps below describe how to create a custom action plugin.</p><ol type="1">
<li>Create a new ROS package, e.g., <code>event_detector_custom_action_plugin</code>, with dependencies on <code><a class="el" href="namespaceevent__detector.html">event_detector</a></code> and <code>pluginlib</code> in its <code>package.xml</code>. <div class="fragment"><div class="line"><span class="comment">&lt;!-- ... --&gt;</span></div>
<div class="line">&lt;<span class="keywordtype">depend</span>&gt;<span class="keyword">event_detector</span>&lt;/<span class="keywordtype">depend</span>&gt;</div>
<div class="line">&lt;<span class="keywordtype">depend</span>&gt;<span class="keyword">pluginlib</span>&lt;/<span class="keywordtype">depend</span>&gt;</div>
<div class="line"><span class="comment">&lt;!-- ... --&gt;</span></div>
</div><!-- fragment --></li>
<li>Create a new header (<code>.hpp</code>) and a new implementation file (<code>.cpp</code>) for a new analysis rule, e.g., <code>src/rules/custom_action_plugin_rule/CustomActionPluginRule.cpp</code>.</li>
<li>Declare a new plugin class in a new file <code>plugins.xml</code> on the package's top level. <div class="fragment"><div class="line">&lt;<span class="keywordtype">library</span> <span class="keyword">path</span>=<span class="stringliteral">&quot;event_detector_custom_action_plugin&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">class</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;event_detector_custom_action_plugin::CustomActionPluginRule&quot;</span> <span class="keyword">base_class_type</span>=<span class="stringliteral">&quot;event_detector::AnalysisRule&quot;</span> /&gt;</div>
<div class="line">&lt;/<span class="keywordtype">library</span>&gt;</div>
</div><!-- fragment --></li>
<li>Set up the package's <code>CMakeLists.txt</code> to build a shared library that is exported as a plugin. <div class="fragment"><div class="line">project(event_detector_custom_action_plugin)</div>
<div class="line"># ...</div>
<div class="line">set(TARGET_NAME ${PROJECT_NAME})</div>
<div class="line">add_library(${TARGET_NAME} SHARED</div>
<div class="line">  src/rules/custom_action_plugin_rule/CustomActionPluginRule.cpp</div>
<div class="line">)</div>
<div class="line"># ...</div>
<div class="line">ament_target_dependencies(${TARGET_NAME}</div>
<div class="line">  event_detector</div>
<div class="line">  pluginlib</div>
<div class="line">  # ...</div>
<div class="line">)</div>
<div class="line"># ...</div>
<div class="line">pluginlib_export_plugin_description_file(event_detector plugins.xml)</div>
<div class="line"># ...</div>
</div><!-- fragment --></li>
<li>Add a new rule-specific section to the plugin's parameter file <code>config/params.yml</code>, where you can enable the new analysis rule and specify parameters. <div class="fragment"><div class="line"># ...</div>
<div class="line">rules:</div>
<div class="line">  - event_detector_custom_action_plugin::CustomActionPluginRule</div>
<div class="line">rule_params:</div>
<div class="line">  enabled: true</div>
<div class="line">  parameters:</div>
<div class="line">    new_custom_param: 3.14</div>
</div><!-- fragment --></li>
<li>Implement the action plugin logic in the core analysis rule. The analysis rule has to inherit <code><a class="el" href="classevent__detector_1_1AnalysisRule.html" title="Abstract class defining a rule for identifying relevant data.">event_detector::AnalysisRule</a></code> and override a set of abstract functions. A minimal implementation is given below. The most relevant function to implement is <code>CustomActionPluginRule::evaluate()</code>, which is periodically called as part of rule evaluation. For reference, check out the documentation of the <a href="./event_detector/include/event_detector/AnalysisRule.hpp">core abstract <code>AnalysisRule</code> class</a>. <div class="fragment"><div class="line"><span class="comment">// include/event_detector_custom_action_plugin/rules/custom_action_plugin_rule/CustomActionPluginRule.hpp</span></div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"><span class="preprocessor">#include &lt;event_detector/AnalysisRule.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>event_detector_custom_action_plugin {</div>
<div class="line"><span class="keyword">class </span>CustomActionPluginRule : <span class="keyword">public</span> <a class="code hl_class" href="classevent__detector_1_1AnalysisRule.html">event_detector::AnalysisRule</a> {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  std::string getRuleName() <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span> loadRuleParameters() <span class="keyword">override</span>;</div>
<div class="line">  <span class="keywordtype">void</span> onInitialize() <span class="keyword">override</span>;</div>
<div class="line"> <span class="keyword">protected</span>:</div>
<div class="line">  <span class="keywordtype">void</span> evaluate() <span class="keyword">override</span>;</div>
<div class="line">}</div>
<div class="line">}</div>
<div class="ttc" id="aclassevent__detector_1_1AnalysisRule_html"><div class="ttname"><a href="classevent__detector_1_1AnalysisRule.html">event_detector::AnalysisRule</a></div><div class="ttdoc">Abstract class defining a rule for identifying relevant data.</div><div class="ttdef"><b>Definition</b> <a href="AnalysisRule_8hpp_source.html#l00040">AnalysisRule.hpp:40</a></div></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="comment">// src/rules/custom_action_plugin_rule/CustomActionPluginRule.cpp</span></div>
<div class="line"><span class="preprocessor">#include &lt;event_detector_custom_action_plugin/rules/custom_action_plugin_rule/CustomActionPluginRule.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;pluginlib/class_list_macros.hpp&gt;</span></div>
<div class="line">PLUGINLIB_EXPORT_CLASS(event_detector_custom_action_plugin::CustomActionPluginRule,</div>
<div class="line">                       <a class="code hl_class" href="classevent__detector_1_1AnalysisRule.html">event_detector::AnalysisRule</a>)</div>
<div class="line"><span class="keyword">namespace </span>event_detector_custom_action_plugin {</div>
<div class="line">std::string TemplateRule::getRuleName()<span class="keyword"> const </span>{</div>
<div class="line">  <span class="keywordflow">return</span> <span class="stringliteral">&quot;event_detector_custom_action_plugin::CustomActionPluginRule&quot;</span>;</div>
<div class="line">}</div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Build the action plugin. <div class="fragment"><div class="line"># ROS workspace$</div>
<div class="line">colcon build --packages-up-to event_detector_custom_action_plugin</div>
</div><!-- fragment --></li>
</ol>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md14"></a>
Research Article</h1>
<p>If you are interested in the role of event detection in modern automated driving systems and Cooperative Intelligent Transport Systems (C-ITS), please check out our associated research article on the topic and consider citing it if you are using the event detector for your own research.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Event Detection in C-ITS: Classification, Use Cases, and Reference Implementation</b> <br  />
 *(<a href="https://www.researchgate.net/publication/388993060_Event_Detection_in_C-ITS_Classification_Use_Cases_and_Reference_Implementation">ResearchGate</a>)* <br  />
</p>
<p><a href="https://www.ika.rwth-aachen.de/en/institute/team/vehicle-intelligence-automated-driving/reiher.html">Lennart Reiher</a>, <a href="https://www.ika.rwth-aachen.de/en/institute/team/vehicle-intelligence-automated-driving/lampe.html">Bastian Lampe</a>, <a href="https://www.ika.rwth-aachen.de/en/institute/team/vehicle-intelligence-automated-driving/zanger.html">Lukas Zanger</a>, <a href="https://www.ika.rwth-aachen.de/de/institut/team/fahrzeugintelligenz-automatisiertes-fahren/woopen.html">Timo Woopen</a>, <a href="https://www.ika.rwth-aachen.de/en/institute/team/univ-prof-dr-ing-lutz-eckstein.html">Lutz Eckstein</a> <br  />
 <a href="https://www.ika.rwth-aachen.de/en/">Institute for Automotive Engineering (ika), RWTH Aachen University</a></p>
<p><sup><em>Abstract</em> – The transition from traditional hardware-centric vehicles to software-defined vehicles is largely driven by a switch to modern architectural patterns of software, including service orientation and microservices. Automated driving systems (ADS), and even more so, Cooperative Intelligent Transport Systems (C-ITS), come with requirements for scalability, modularity, and adaptability that cannot be met with conventional software architectures. The complexity and dynamics of future mobility systems also suggest to employ ideas of the event-driven architecture paradigm: distributed systems need to be able to detect and respond to events in real-time and in an asynchronous manner. In this paper, we therefore stress the importance of data-driven event detection in the context of ADS and C-ITS. First, we propose a classification scheme for event-detection use cases. We then describe a diverse set of possible use cases and apply the classification scheme to a selection of concrete, innovative examples. Last, we present a modular event detection software framework that we publish as open-source software to foster further research and development of complex C-ITS use cases, but also for robotics in general.</sup> </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md15"></a>
Acknowledgements</h1>
<p>This work is accomplished within the projects <em>6GEM</em> (FKZ 16KISK036K), <em>autotech.agil</em> (FKZ 01IS22088A), and <em>UNICAR.agil</em> (FKZ 16EMO0284K). We acknowledge the financial support for the projects by the <em>Federal Ministry of Education and Research of Germany (BMBF)</em>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
